# AVW200 (Measure AVW200)

The AVW200 instruction is used to set up the datalogger to read measurements from an AVW200 Series Vibrating Wire Spectrum Analyzer.

## Syntax

AVW200(Result,ComPort,NeighborAddr,PakBusAddr,Dest,AVWChan,MuxChannel,Reps,BeginFreq,EndFreq,ExVolt,Therm50_60Hz,Multiplier, Offset,AmpThreshold[optional] )

The following partial program shows the use of the AVW200 instruction. The device is connected to the datalogger via the datalogger'sCOMC1port.

```
'Declare Variables and Units
Public BattV
Public Data1, Data2
Public Mux1(16,6), Mux2(16,6)

'Define Data Tables
DataTable(VWTable1,True,-1)
DataInterval(0,90,Sec,10)
Sample (96,Mux1(),IEEE4)
Sample (96,Mux2(),IEEE4)
Minimum(1,BattV,FP2,False,False)
EndTable

'Main Program
BeginProg
SerialOpen (COMC1,38400,0,0,0)
Scan(90,Sec,1,0)
AVW200(Data1,COMC1,200,200,Mux1(1,1),1,1,16,450,3000,2,_60Hz,1,0)
AVW200(Data2,COMC1,200,200,Mux2(1,1),2,1,16,450,3000,2,_60Hz,1,0)
Battery(BattV)
CallTable(VWTable1)
NextScan
EndProg
```

## Remarks

This instruction is used to read measurements from one or more vibrating wire sensors when the sensors are connected to the AVW200 channels directly or connected to a multiplexer connected to the AVW200. In addition to frequency, diagnostic information is returned for the sensor (see the [Dest](../parameters/AVW200dest10.md) parameter).

The first execution of the instruction sets up the AVW200; subsequent instructions retrieve the data values. If different beginning and ending frequencies are required to measure different types of sensors, use multiple AVW200 instructions. The maximum scan rate for an AVW200 program is 2 seconds per sensor.If the program is compiled in pipeline mode, the AVW200 will make the measurement before the scan interval occurs, with the timing being such that the measurement is ready when the scan occurs. If the program is compiled in sequential mode, the measurement is made on the scan interval and the datalogger waits for the response.

Use [SDI12Recorder](sdi12recorder.md) to trigger and retrieve measurements from the AVW200 using SDI12.

Use [GetVariables](getvariables.md) to retrieve values from the AVW200's status table. This can be used to return the RF signal level (RfSignalLevel in the status table), battery voltage (BattVoltage), or other values of interest. A full list of status table values is provided in an appendix of the AVW200 manual.

The AVW200 instruction is a processing instruction. The program should be run in SequentialMode if the instruction is called outside of the main scan (for example, in a subroutine or if called within a conditional statement).

## Parameters

# Result

Stores the success or failure of the datalogger's communication attempt with the AVW200. The result codes are as follows:

| Code | Description                                                                                                                  |
| ---- | ---------------------------------------------------------------------------------------------------------------------------- |
| 0    | Communication successful. Values have been written to the destination array.                                                 |
| â‰¥1   | Number of communication failures. Old values will remain in the destination array. Resets to 0 upon successful communication |
| -3   | First communication. Values will be available on the next scan.                                                              |
| -5   | Request for another measurement received when the AVW200 is busy making a measurement.                                       |
| -20  | Out of Comms memory                                                                                                          |

Type: Variable

# ComPort

Specifies the communications port that will be used to communicate with the AVW200. Enter an alphanumeric code:

| Alphanumeric | Description                                |
| ------------ | ------------------------------------------ |
| ComRS232     | RS232 port of the datalogger               |
| ComME        | Datalogger's CS I/O port; modem enabled    |
| ComSDC7      | Datalogger's CS I/O port; SDC 7            |
| ComSDC8      | Datalogger's CS I/O port; SDC 8            |
| ComSDC10     | Datalogger's CS I/O port; SDC10            |
| ComSDC11     | Datalogger's CS I/O port; SDC 11           |
| ComC1        | Datalogger's control ports 1 (TX) & 2 (RX) |
| ComC3        | Datalogger's control ports 3 (TX) & 4 (RX) |
| ComC5        | Datalogger's control ports 5 (TX) & 6 (RX) |
| ComC7        | Datalogger's control ports 7 (TX) & 8 (RX) |

Type: Variable or predefined constant

# NeighborAddr (PakBus Address to Neighbor Datalogger)

Used to specify a static route to the destination datalogger (for example, thePakBus

**Note:** PakBus is a proprietary communication protocol developed by Campbell Scientific to facilitate communications between Campbell Scientific devices. Similar in concept to IP (Internet Protocol), PakBus is a packet-switched network protocol with routing capabilities. A registered trademark of Campbell Scientific, Inc.

address of a "neighbor" datalogger that the host can go through to communicate with the destination datalogger).Note that the datalogger will attempt to use this route only until it "learns" a dynamic route to the destination datalogger.

If 0 is entered, the destination device is assumed to be a neighbor (i.e., the host datalogger can communicate with the destination directly). If a non-valid PakBus address is entered (a negative number or a number greater than 4094), the route to the destination device will be "autodiscovered" by other means in the PakBus network (such as beaconing or a Hello messages). If the instruction has a ResultCode parameter, an error code is returned until the route is discovered. When autodiscovery is used, the COMPort parameter is ignored.

Type: Integer between 1 and 4094

**NOTE:** By default,Campbell Scientificsoftware uses the following PakBus addresses: LoggerNet 4094, VisualWeather 4094, PC400 4093, PC200W 4092, PConnect/PConnectCE 4091, RTDAQ 4090, Device Configuration Utility 4089.

# PakBusAddr (PakBus Address)

ThePakbus

**Note:** PakBus is a proprietary communication protocol developed by Campbell Scientific to facilitate communications between Campbell Scientific devices. Similar in concept to IP (Internet Protocol), PakBus is a packet-switched network protocol with routing capabilities. A registered trademark of Campbell Scientific, Inc.

address of the device that will be contacted as a result of this instruction. Each PakBus device in the network must have a unique address.

If PakBus encryption is enabled in the datalogger, by default the datalogger will encrypt the communications sent using PakBus communication. To disable encryption for one or more Pakbus addresses, use the EncryptExempt instruction. This is useful if a remote device does not support encryption (such as a CR200 or an AVW200).

Type: Integer between 1 and 4094

**NOTE:** By default,Campbell Scientificsoftware uses the following PakBus addresses: LoggerNet 4094, VisualWeather 4094, PC400 4093, PC200W 4092, PConnect/PConnectCE 4091, RTDAQ 4090, Device Configuration Utility 4089, Konect GDS a value in the range of 4000 4050. 4095 is a broadcast address that can be used in a limited number of instructions.

For the AVW200 instruction, the PakBusAddr parameter identifies the PakBus address of the AVW200 with which the host datalogger is trying to communicate. Valid entries are 1 through 4094, or a variable can be used. Each PakBus device in the network must have a unique address.

**NOTE:** By default, LoggerNet uses PakBus address 4094 and PC400 uses 4093.

# Destination (Dest)

The variable array in which to store the results of the instruction. Dest is a single-dimensioned array of 5 or 6 (depending upon whether a thermistor is being measured) if only one sensor is being measured. Dest is a multi-dimensioned array of 5 or 6 if multiple sensors are being measured using a multiplexer. The first dimension is set equal to the number of sensors being measured and the second dimension is set equal to the number of values returned for each sensor (5 or 6). For example, to measure 4 sensors with thermistor measurements attached to a multiplexer, Dest would be declared as Array(4,6). Values for sensor 1 would be stored in Array(1,1) through Array(1,6), values for sensor 2 stored in Array (2,1) through (2,6), etc.

Type: Variable array

For the AVW200 instruction, the values returned for each sensor are:

(1) Frequency in Hertz

(2) Amplitude in mV RMS

(3) Signal-to-noise ratio

(4) Noise frequency

(5) Decay ratio

(6) Thermistor in ohms (if measured)

If communication is unsuccessful,NANs

**Note:** Not a number. A data word indicating a measurement or processing error. Voltage overrange, SDI-12 sensor error, and undefined mathematical results can produce NAN.

are stored. If the amplitude is < 0.01 mV, -9,999,999 is stored for frequency (Array element 1) when the device is communicating via SDI-12, or NAN is stored for all other scenarios.

If there is an inductor failure or other power supply problem, -555,555 is stored for array element 1 (frequency)

# AVWChan

The channel on the AVW200 where the sensor or multiplexer is wired. Valid options are 1 (1V+/-) or 2 (2V+/-).

Type: Predefined constant or variable

# MuxChannel

The channel on the multiplexer where measurements should start. Valid options are 1 through 32; anything outside of this range returns an error. Enter 1 if a multiplexer is not used.

Type: Constant or variable

# Reps

The number of measurements to be made on the multiplexer. This parameter does not affect the AVW200Chan.

Type: Constant or Variable

# BeginFreq (Starting Frequency)

The starting frequency to use for the vibrating wire measurement (Hz). The minimum value that can be entered is 100.

Refer to the specifications of the vibrating wire sensor for recommended BeginFreq and EndFreq values (typical sweep range is 450 to 6000).

Type: Constant or variable

# EndFreq

The ending frequency to use for the vibrating wire measurement (Hz). The maximum value that can be entered is 6500.

Refer to the specifications of the vibrating wire sensor for recommended BeginFreq and EndFreq values (typical sweep range is 450 to 6000).

Type: Constant or variable

# ExVolt (Excitation Voltage)

The excitation voltage to be used to excite the vibrating wire. Valid options are 1 (5 V peak-to-peak) or 2 (12 V peak-to-peak).

Type: Constant or variable

# Therm50_60Hz (Thermistor Integration Time)

Sets the integration time for the thermistor in the vibrating wire sensor.

| Code | Description               |
| ---- | ------------------------- |
| 0    | No thermistor measurement |
| 60   | Use 60 Hz noise rejection |
| 50   | Use 50 Hz noise rejection |

Type: Constant

# Mult, Offset (Multiplier and Offset)

Factors by which to scale the raw results of the measurement. Typically used to convert the raw measurement to engineering units or to units other than which is output. For example, the TCDiff instruction measures a thermocouple and outputs temperature in degrees C. A multiplier of 1.8 and an offset of 32 will convert the temperature to degrees F.

For temperature measurements, a multiplier (mult) of 1 and an offset of 0, would output in degrees Celsius. For analog measurements, a multiplier (mult) of 1 and an offset of 0, would output the measured voltage in millivolts divided by the excitation voltage in volts.

If Repetitions of greater than 1 are used for this instruction, Repetitions can also be used for the Multiplier and Offset.[SeeMultipliers, Offsets, and Disable Variables with Repetitionsfor more information.](../Info/multipliersoffsets.md)

Type: Constant, Variable, Array, or Expression

# AmpThreshold (Amplitude Threshold)

An optional parameter that is used to define a minimum value, in millivolts, for the amplitude of the signal. If an amplitude of less than the threshold is returned, NAN will be stored for the Frequency measurement (Dest(1)). If AmpThreshold is omitted, a default value of 0.01 mV is used. If a value of less than 0.01 mV is entered for this parameter, the precompiler will return an error. For best results, use an amplitude threshold that is an integer multiple of 0.0625 (for additional information, refer to the AVW200 manual).

Type: Constant

The AVW200 instruction will be run in SequentialMode under the following circumstances:

- The AVW200() is in a [SlowSequence](slowsequence.md) or is forced to sequential mode with the [SequentialMode](sequentialmodepipeli2.md) instruction.

- One or more of the following AVW200() parameters are assigned as variables: PakBusAddr, AVWChan, MuxChan, AVWReps, AVWBeginFreq, AVWEndFreq or AVWExVolt. Even if the datalogger program is compiled and running in the PipeLine mode, the AVW200 instruction will run in a sequential mode of operations.

- The AVW200() instruction occurs in a conditional statement or subroutine.
