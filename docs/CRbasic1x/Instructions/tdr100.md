# TDR100

The TDR100 instruction is used to measure one or more time domain reflectivity (TDR) probes attached to a TDR100 device.

## Syntax

TDR100(Dest,SDMAddress,Option,Mux/ProbeSelect,WaveAvg,Vp,Points,CableLength,WindowLength,ProbeLength,ProbeOffset,Mult, Offset)

The following program uses the TDR100 instruction to measure La/L for a probe attached to the TDR100. The multiplier and offset convert the La/L value to water content using the Ledieu linear calibration function.

```
'Declare Variables
Public H2OContent

DataTable (TDR,1,-1)
DataInterval (0,5,Min,10)
Average (1,H2OContent,FP2,0)
EndTable

BeginProg
Scan (5,Sec,3,0)
'Measure TDR probe; convert to water content
TDR100(H2OContent,0,0,0001,4,1.0,251,5.75,5,.3,0.085,0.1138,-0.1758)
CallTable TDR
NextScan
EndProg
```

## Remarks

This instruction can be used to measure one TDR probe connected to the TDR100 directly or multiple TDR probes connected to one or more SDMX50 multiplexers.

## Parameters

# Dest

A variable or variable array in which to store the results of the measurement. The variable must be dimensioned to accommodate all of the values returned by the instruction, which is determined by the Option parameter.

Type: Variable or Variable Array

# SDMAddress (Address of Device)

Defines the address of the device with which to communicate. ValidSDM

**Note:** Synchronous Device for Measurement. A processor-based peripheral device or sensor that communicates with the datalogger via hardwire over a short distance using a protocol proprietary to Campbell Scientific.

addresses are 0 through 14. Address 15 is reserved for the SDMTrigger instruction.

Some SDM instructions support repetitions. If a Reps parameter is present and it is greater than 1, the data logger will increment the SDM address used in the instruction for each subsequent device with which it communicates.

# Option

Determines the output of the instruction.

| Code | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ---- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 0    | Measure La/L (ratio of apparent to physical probe rod length)                                                                                                                                                                                                                                                                                                                                                                                                           |
| 1    | Collect Waveform values - Outputs reflection waveform values as an array of floating point numbers with a range of -1 to 1. The waveform values are prefaced by a header containing values of key parameters for this instruction including averaging, propagation velocity, points, cable length, window length, probe length, probe offset, multiplier, and offset. For the TDR200, noise rejection frequency, filter level, and Laa are also included in the header. |
| 2    | Collect Waveform plus First Derivative - Returns (2\* n-5)+9 values where n is the number of waveform reflection values specified by the Points parameter.                                                                                                                                                                                                                                                                                                              |
| 3    | Measure Electrical Conductivity - Outputs a value that when multiplied by the Multiplier parameter determines soil bulk electrical conductivity in S/m.                                                                                                                                                                                                                                                                                                                 |

Type: Constant

# Mux/ProbeSelect

Used to define the setup of any multiplexers and attached probes in the system. The addressing scheme used is ABCR, where A = level 1 multiplexer channel, B = level 2 multiplexer channel, C = level 3 multiplexer channel, and R = the number of consecutive probes to be read, starting with the channel specified by the ABC value (maximum of 8). 0 is entered for any level not used.

Type: Constant

# WaveAvg

Used to define the number of waveform reflections averaged by the TDR100/200 to give a single result. A waveform averaging value of 4 provides good signal-to-noise ratio under typical applications. Under high noise conditions averaging can be increased. The maximum averaging possible is 128.

Type: Constant or Variable

# Vp

Allows you to enter the propagation velocity of a cable when using the instruction to test for cable lengths or faults. Vp adjustment is not necessary for soil water content or electrical conductivity measurement and should be set to 1.0 for output Option 1, 2, or 3.

Type: Constant or Variable

# Points

Used to define the number of values in the displayed or collected waveform (20 to 2048 for the TDR100; 20 to 10,112 for the TDR200). An entry of 251 is recommended for soil water measurements. The waveform consists of the number of Points equally spaced over the WindowLength.

Type: Constant

# CableLength

Specifies the cable length, in meters, of the TDR probes. If a 0 is entered for the Option parameter, cable length is used by the analysis algorithm to begin searching for the TDR probe. If a 1 or 2 is entered for the Option parameter, cable length is the distance to the start of the collected waveform.

The value used for CableLength is best determined using PCTDR with the Vp = 1.0. Adjust the CableLength and WindowLength values in PCTDR until the probe reflection can be viewed. Subtract about 0.5 meters from the distance associated with the beginning of the probe reflection.

Note that if CableLength is a scalar the specified CableLength applies to all probes read by this instruction; therefore, all probes must have the same cable lengths. However, CableLength can be a variable array loaded with the cable length values to use for each probe; e.g., CableLength(1) is used for the first probe, CableLength(2) is use for the second probe, etc. In this instance, the CableLength array should be loaded with values prior to the start of the scan.

Type: Constant or Variable Array

# WindowLength

Specifies the length, in meters, of the waveform to collect or analyze. The waveform begins at the CableLength and ends at the CableLength + WindowLength. This is an apparent length because the value set for Vp may not be the actual propagation velocity. For water content measurements, the WindowLength must be large enough to contain the entire probe reflection for probes with 20 to 30 cm rods. A Vp = 1 and Window length = 5 is recommended.

Type: Constant or Variable

# ProbeLength

Specifies the length, in meters, of the probe rods that are exposed to the medium being measured. The value of this parameter only has an affect when Option 0, La/L, is used for the measurement.

Type: Constant or Variable

# ProbeOffset

An apparent length value used to correct for the portion of the probe rods that may be encapsulated in epoxy and not surrounded by soil or other medium being measured. This value is supplied by Campbell Scientific for the probes we manufacture. The value of this parameter only has an affect when Option 0, La/L, is used for the measurement.

Type: Constant or Variable

# Mult, Offset (Multiplier and Offset)

Factors by which to scale the raw results of the measurement. Typically used to convert the raw measurement to engineering units or to units other than which is output. For example, the TCDiff instruction measures a thermocouple and outputs temperature in degrees C. A multiplier of 1.8 and an offset of 32 will convert the temperature to degrees F.

For temperature measurements, a multiplier (mult) of 1 and an offset of 0, would output in degrees Celsius. For analog measurements, a multiplier (mult) of 1 and an offset of 0, would output the measured voltage in millivolts divided by the excitation voltage in volts.

If Repetitions of greater than 1 are used for this instruction, Repetitions can also be used for the Multiplier and Offset.[SeeMultipliers, Offsets, and Disable Variables with Repetitionsfor more information.](../Info/multipliersoffsets.md)

Type: Constant, Variable, Array, or Expression
